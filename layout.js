var layout = [
  2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
  2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2,
  2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 1, 2,
  2, 4, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 4, 2,
  2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 1, 2,
  2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2,
  2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 1, 2,
  2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 1, 2,
  2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2,
  2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2,
  2, 2, 2, 2, 2, 2, 1, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 1, 2, 2, 2, 2, 2, 2,
  2, 2, 2, 2, 2, 2, 1, 2, 2, 0, 2, 2, 2, 0, 0, 2, 2, 2, 0, 2, 2, 1, 2, 2, 2, 2, 2, 2,
  2, 2, 2, 2, 2, 2, 1, 2, 2, 0, 2, 3, 0, 0, 0, 0, 3, 2, 0, 2, 2, 1, 2, 2, 2, 2, 2, 2,
  0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 2, 0, 0, 0, 0, 0, 0, 2, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0,
  2, 2, 2, 2, 2, 2, 1, 2, 2, 0, 2, 3, 0, 0, 0, 0, 3, 2, 0, 2, 2, 1, 2, 2, 2, 2, 2, 2,
  2, 2, 2, 2, 2, 2, 1, 2, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 0, 2, 2, 1, 2, 2, 2, 2, 2, 2,
  2, 2, 2, 2, 2, 2, 1, 2, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 0, 2, 2, 1, 2, 2, 2, 2, 2, 2,
  2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 2,
  2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 1, 2,
  2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 1, 2,
  2, 4, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 4, 2,
  2, 2, 2, 1, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 1, 2, 2, 2,
  2, 2, 2, 1, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 1, 2, 2, 2,
  2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 2,
  2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2,
  2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2,
  2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2,
  2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2
]

const TYPE = {
  empty: 0,
  food: 1,
  wall: 2,
  ghost: 3,
  powerPellet: 4,
  pacman: 5
}

const changeTypeTo = (newType, rowNo_Position, columnNo) => {
  const index = getIndex(rowNo_Position, columnNo);
  layout[index] = newType;
}

const makeEmpty = (rowNo_Position, columnNo) => {
  const index = getIndex(rowNo_Position, columnNo);
  layout[index] = TYPE.empty;
}

const isWall = (rowNo_Position, columnNo) => {
  return getLayoutElementType(rowNo_Position, columnNo) === TYPE.wall;
}

const isGhost = (rowNo_Position, columnNo) => {
  return getLayoutElementType(rowNo_Position, columnNo) === TYPE.ghost;
}

const isPenetrable = (rowNo_Position, columnNo) => {
  return !isWall(rowNo_Position, columnNo) && !isGhost(rowNo_Position, columnNo);
}

const getRandomPositionWithTYpe = (compare) => {
  var position;
  do {
    position = getRandomGridPosition();
  } while (!compare(position));

  return position;
}

const getRandomGridPosition = () => {
  var position = { x: 0, y: 0 };
  position.x = Math.floor(Math.random() * getGridColumns()) + 1;
  position.y = Math.floor(Math.random() * getGridRows()) + 1;

  return position;
}

const getLayoutElementType = (rowNo_Position, columnNo) => {
  let index = getIndex(rowNo_Position, columnNo);
  return layout[index];
}

const getIndex = (rowNo_Position, columnNo) => {
  if (columnNo) {
    return (rowNo_Position - 1) * getGridRows() + columnNo - 1;
  }

  return (rowNo_Position.y - 1) * getGridRows() + rowNo_Position.x - 1;
}

const layoutInit = (gameBoard) => {
  drawLayout(gameBoard);
  themeInit();
  drawPacman(gameBoard);
}

const updateLayout = () => {
  updateFood();
  updatePowerPellet();
  updatePacman();
  updateGhosts();
}

const drawLayout = (gameBoard) => {
  for (let r = 0; r < getGridRows(); r++) {
    for (let c = 0; c < getGridColumns(); c++) {

      let index = r * getGridRows() + c;

      if (layout[index] === TYPE.food) {
        let newFoodElement = getNewFoodElement(r + 1, c + 1);
        gameBoard.appendChild(newFoodElement);

      } else if (layout[index] === TYPE.wall) {
        let newWallElement = getNewWall(r + 1, c + 1);
        gameBoard.appendChild(newWallElement);

      } else if (layout[index] === TYPE.powerPellet) {
        let newPowerPellet = getNewPowerPellet(r + 1, c + 1);
        gameBoard.appendChild(newPowerPellet);

      } else if (layout[index] === TYPE.ghost) {
        let newGhostElement = getNewGhostElement(r + 1, c + 1);
        gameBoard.appendChild(newGhostElement);
      }
    }
  }
}